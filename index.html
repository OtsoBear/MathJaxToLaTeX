<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathML to LaTeX Converter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        textarea {
            width: 100%;
            min-height: 200px;
            margin-bottom: 10px;
            font-family: monospace;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #output {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .example {
            background-color: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-left: 3px solid #4CAF50;
        }
    </style>
</head>
<body>
    <h1>MathML to LaTeX Converter</h1>
    
    <h2>Input (MathML)</h2>
    <textarea id="mathmlInput" placeholder="Paste MathML content here..."></textarea>
    <button onclick="convertToLatex()">Convert to LaTeX</button>
    
    <h2>Output (LaTeX)</h2>
    <div id="output"></div>
    
    <h3>Example:</h3>
    <div class="example">
        <p>Paste MathML content like:</p>
        <code>&lt;g data-mml-node="math"&gt;...&lt;/g&gt;</code>
    </div>
    
    <!-- Include the Unicode mapping file -->
    <script src="fileunicode.js"></script>
    
    <!-- Include the translation logic -->
    <script src="translate.js"></script>
    
    <script>
        function convertToLatex() {
            const mathmlInput = document.getElementById('mathmlInput').value;
            console.log('INPUT:', mathmlInput);
            
            try {
                // Create a temporary div to hold the parsed MathML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = mathmlInput;
                console.log('PARSED HTML:', tempDiv.innerHTML);
                
                // Get the MathML node
                const mathNode = tempDiv.querySelector('[data-mml-node="math"]');
                console.log('Found math node:', mathNode ? 'Yes' : 'No');
                
                if (!mathNode) {
                    document.getElementById('output').textContent = "No valid MathML found!";
                    return;
                }
                
                // Log the structure of the math node for debugging
                console.log('Math node structure:', mathNode.outerHTML);
                
                // Convert the MathML node to LaTeX - using the function from translate.js
                console.log('Starting conversion to LaTeX');
                const latex = convertMathMLToLatex(mathNode);
                console.log('FINAL LATEX:', latex);
                
                // Display the result
                document.getElementById('output').textContent = latex;
            } catch (error) {
                document.getElementById('output').textContent = "Error converting MathML: " + error.message;
                console.error('CONVERSION ERROR:', error);
            }
        }
        
        // Add example when page loads
        window.onload = function() {
            console.log('Page loaded');
            // Check if the Unicode mapping file was loaded properly
            if (typeof unicode_to_tex !== 'undefined') {
                console.log("Unicode mapping file loaded successfully!");
                console.log(`Total Unicode mappings available: ${Object.keys(unicode_to_tex).length}`);
            } else {
                console.error("Unicode mapping file not loaded correctly!");
            }
            
            // Pre-populate the input area with example
            const exampleInput = `<g data-mml-node="math" xmlns:ns2="http://purl.org/dc/terms/" xmlns:ns3="http://www.sanoma-learning.com/metadata/sl" xmlns:ns4="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:wrs="http://www.wiris.com/xml/mathml-extension" data-semantic-structure="(18 (16 0 15 (10 1 2 3)) 4 (17 (14 5 13 6) 7 (12 8 11 9)))"><g data-mml-node="mrow" data-semantic-type="relseq" data-semantic-role="equality" data-semantic-annotation="depth:1" data-semantic-id="18" data-semantic-children="16,17" data-semantic-content="4" data-semantic-owns="16 4 17" aria-level="0" aria-posinset="1" aria-setsize="1" role="treeitem" aria-owns="16 4 17" data-semantic-speech="<mark name=&quot;0&quot;/> <say-as interpret-as=&quot;character&quot;>f</say-as> <mark name=&quot;10&quot;/> of <mark name=&quot;2&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as> <break time=&quot;250ms&quot;/> <mark name=&quot;4&quot;/> equals <mark name=&quot;5&quot;/> cosine <mark name=&quot;6&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as> <mark name=&quot;7&quot;/> minus <mark name=&quot;8&quot;/> sine <mark name=&quot;9&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠋⠷⠭⠾⠀⠨⠅⠀⠉⠕⠎⠀⠭⠤⠎⠊⠝⠀⠭"><g data-mml-node="mrow" data-semantic-added="true" data-semantic-type="appl" data-semantic-role="simple function" data-semantic-annotation="clearspeak:simple;depth:2" data-semantic-id="16" data-semantic-children="0,10" data-semantic-content="15,0" data-semantic-parent="18" data-semantic-owns="0 15 10" aria-level="1" aria-posinset="1" aria-setsize="3" role="treeitem" aria-owns="0 15 10" data-semantic-speech="<mark name=&quot;0&quot;/> <say-as interpret-as=&quot;character&quot;>f</say-as> <mark name=&quot;10&quot;/> of <mark name=&quot;2&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠋⠷⠭⠾"><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="simple function" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple;nemeth:number;depth:3" data-semantic-id="0" data-semantic-parent="16" data-semantic-operator="appl" aria-level="2" aria-posinset="1" aria-setsize="3" role="treeitem" data-semantic-speech="<mark name=&quot;0&quot;/> <say-as interpret-as=&quot;character&quot;>f</say-as>" data-semantic-braille="⠋"><use data-c="1D453" xlink:href="#MJX-1-MM-I-1D453"></use></g><g data-mml-node="mo" data-semantic-type="punctuation" data-semantic-role="application" data-semantic-id="15" data-semantic-parent="16" data-semantic-added="true" data-semantic-operator="appl" aria-level="2" aria-posinset="2" aria-setsize="3" role="treeitem" transform="translate(552,0)" data-semantic-speech="<mark name=&quot;15&quot;/> of" data-semantic-braille="⠀"><use data-c="2061" xlink:href="#MJX-1-MM-N-2061"></use></g><g data-mml-node="mrow" data-semantic-added="true" data-semantic-type="fenced" data-semantic-role="leftright" data-semantic-annotation="depth:3" data-semantic-id="10" data-semantic-children="2" data-semantic-content="1,3" data-semantic-parent="16" data-semantic-owns="1 2 3" aria-level="2" aria-posinset="3" aria-setsize="3" role="treeitem" aria-owns="1 2 3" transform="translate(552,0)" data-semantic-speech="<mark name=&quot;2&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠷⠭⠾"><g data-mml-node="mo" data-semantic-type="fence" data-semantic-role="open" data-semantic-id="1" data-semantic-parent="10" data-semantic-operator="fenced" aria-level="3" aria-posinset="1" aria-setsize="3" role="treeitem" data-semantic-speech="<mark name=&quot;1&quot;/> open paren" data-semantic-braille="⠷"><use data-c="28" xlink:href="#MJX-1-MM-N-28"></use></g><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple;depth:4" data-semantic-id="2" data-semantic-parent="10" aria-level="3" aria-posinset="2" aria-setsize="3" role="treeitem" transform="translate(389,0)" data-semantic-speech="<mark name=&quot;2&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠭"><use data-c="1D465" xlink:href="#MJX-1-MM-I-1D465"></use></g><g data-mml-node="mo" data-semantic-type="fence" data-semantic-role="close" data-semantic-id="3" data-semantic-parent="10" data-semantic-operator="fenced" aria-level="3" aria-posinset="3" aria-setsize="3" role="treeitem" transform="translate(961,0)" data-semantic-speech="<mark name=&quot;3&quot;/> close paren" data-semantic-braille="⠾"><use data-c="29" xlink:href="#MJX-1-MM-N-29"></use></g></g></g><g data-mml-node="mo" data-semantic-type="relation" data-semantic-role="equality" data-semantic-id="4" data-semantic-parent="18" data-semantic-operator="relseq,=" aria-level="1" aria-posinset="2" aria-setsize="3" role="treeitem" transform="translate(2179.8,0)" data-semantic-speech="<mark name=&quot;4&quot;/> equals" data-semantic-braille="⠨⠅"><use data-c="3D" xlink:href="#MJX-1-MM-N-3D"></use></g><g data-mml-node="mrow" data-semantic-added="true" data-semantic-type="infixop" data-semantic-role="subtraction" data-semantic-annotation="depth:2" data-semantic-id="17" data-semantic-children="14,12" data-semantic-content="7" data-semantic-parent="18" data-semantic-owns="14 7 12" aria-level="1" aria-posinset="3" aria-setsize="3" role="treeitem" aria-owns="14 7 12" transform="translate(3235.6,0)" data-semantic-speech="<mark name=&quot;5&quot;/> cosine <mark name=&quot;6&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as> <mark name=&quot;7&quot;/> minus <mark name=&quot;8&quot;/> sine <mark name=&quot;9&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠉⠕⠎⠀⠭⠤⠎⠊⠝⠀⠭"><g data-mml-node="mrow" data-semantic-added="true" data-semantic-type="appl" data-semantic-role="prefix function" data-semantic-annotation="clearspeak:simple;depth:3" data-semantic-id="14" data-semantic-children="5,6" data-semantic-content="13,5" data-semantic-parent="17" data-semantic-owns="5 13 6" aria-level="2" aria-posinset="1" aria-setsize="3" role="treeitem" aria-owns="5 13 6" data-semantic-speech="<mark name=&quot;5&quot;/> cosine <mark name=&quot;6&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠉⠕⠎⠀⠭"><g data-mml-node="mi" data-semantic-type="function" data-semantic-role="prefix function" data-semantic-font="normal" data-semantic-annotation="nemeth:number;depth:4" data-semantic-id="5" data-semantic-parent="14" data-semantic-operator="appl" aria-level="3" aria-posinset="1" aria-setsize="3" role="treeitem" data-semantic-speech="<mark name=&quot;5&quot;/> cosine" data-semantic-braille="⠉⠕⠎"><use data-c="63" xlink:href="#MJX-1-MM-N-63"></use><use data-c="6F" xlink:href="#MJX-1-MM-N-6F" transform="translate(444,0)"></use><use data-c="73" xlink:href="#MJX-1-MM-N-73" transform="translate(944,0)"></use></g><g data-mml-node="mo" data-semantic-type="punctuation" data-semantic-role="application" data-semantic-id="13" data-semantic-parent="14" data-semantic-added="true" data-semantic-operator="appl" aria-level="3" aria-posinset="2" aria-setsize="3" role="treeitem" transform="translate(1338,0)" data-semantic-speech="<mark name=&quot;13&quot;/> of" data-semantic-braille="⠀"><use data-c="2061" xlink:href="#MJX-1-MM-N-2061"></use></g><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple;nemeth:number;depth:4" data-semantic-id="6" data-semantic-parent="14" aria-level="3" aria-posinset="3" aria-setsize="3" role="treeitem" transform="translate(1504.7,0)" data-semantic-speech="<mark name=&quot;6&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠭"><use data-c="1D465" xlink:href="#MJX-1-MM-I-1D465"></use></g></g><g data-mml-node="mo" data-semantic-type="operator" data-semantic-role="subtraction" data-semantic-id="7" data-semantic-parent="17" data-semantic-operator="infixop,−" aria-level="2" aria-posinset="2" aria-setsize="3" role="treeitem" transform="translate(2298.9,0)" data-semantic-speech="<mark name=&quot;7&quot;/> minus" data-semantic-braille="⠤"><use data-c="2212" xlink:href="#MJX-1-MM-N-2212"></use></g><g data-mml-node="mrow" data-semantic-added="true" data-semantic-type="appl" data-semantic-role="prefix function" data-semantic-annotation="clearspeak:simple;depth:3" data-semantic-id="12" data-semantic-children="8,9" data-semantic-content="11,8" data-semantic-parent="17" data-semantic-owns="8 11 9" aria-level="2" aria-posinset="3" aria-setsize="3" role="treeitem" aria-owns="8 11 9" transform="translate(3299.1,0)" data-semantic-speech="<mark name=&quot;8&quot;/> sine <mark name=&quot;9&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠎⠊⠝⠀⠭"><g data-mml-node="mi" data-semantic-type="function" data-semantic-role="prefix function" data-semantic-font="normal" data-semantic-annotation="nemeth:number;depth:4" data-semantic-id="8" data-semantic-parent="12" data-semantic-operator="appl" aria-level="3" aria-posinset="1" aria-setsize="3" role="treeitem" data-semantic-speech="<mark name=&quot;8&quot;/> sine" data-semantic-braille="⠎⠊⠝"><use data-c="73" xlink:href="#MJX-1-MM-N-73"></use><use data-c="69" xlink:href="#MJX-1-MM-N-69" transform="translate(394,0)"></use><use data-c="6E" xlink:href="#MJX-1-MM-N-6E" transform="translate(672,0)"></use></g><g data-mml-node="mo" data-semantic-type="punctuation" data-semantic-role="application" data-semantic-id="11" data-semantic-parent="12" data-semantic-added="true" data-semantic-operator="appl" aria-level="3" aria-posinset="2" aria-setsize="3" role="treeitem" transform="translate(1228,0)" data-semantic-speech="<mark name=&quot;11&quot;/> of" data-semantic-braille="⠀"><use data-c="2061" xlink:href="#MJX-1-MM-N-2061"></use></g><g data-mml-node="mi" data-semantic-type="identifier" data-semantic-role="latinletter" data-semantic-font="italic" data-semantic-annotation="clearspeak:simple;nemeth:number;depth:4" data-semantic-id="9" data-semantic-parent="12" aria-level="3" aria-posinset="3" aria-setsize="3" role="treeitem" transform="translate(1394.7,0)" data-semantic-speech="<mark name=&quot;9&quot;/> <say-as interpret-as=&quot;character&quot;>x</say-as>" data-semantic-braille="⠭"><use data-c="1D465" xlink:href="#MJX-1-MM-I-1D465"></use></g></g></g></g></g>`;
            
            document.getElementById('mathmlInput').value = exampleInput;
            
            // Add debug info about the example
            console.log('EXAMPLE LOADED');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = exampleInput;
            const mathNode = tempDiv.querySelector('[data-mml-node="math"]');
            
            if (mathNode) {
                debugNode(mathNode);
                console.log('DATA-SEMANTIC-STRUCTURE:', mathNode.getAttribute('data-semantic-structure'));
            }
        }
    </script>
</body>
</html>
